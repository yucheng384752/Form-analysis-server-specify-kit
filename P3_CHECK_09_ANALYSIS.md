# P3_check_09 資料夾分析報告

## 1. 檢查概要
- **目標資料夾**: `侑特資料/新侑特資料/P3_check_09`
- **參考檔案**: `P3_0902_P24.csv`
- **檢查項目**: 是否符合現行 P3 資料驗證格式 (需包含 `P3_No.` 欄位)

## 2. 檢查結果總結
經過掃描該資料夾下的 100 個 CSV 檔案，結果如下：

- **不符合現行驗證方式的檔案數量**: **100** (全部不符合)
- **主要問題**:
  1. **缺少 `P3_No.` 欄位**: 現行系統依賴此欄位作為唯一識別碼與批號來源。
  2. **`lot no` 格式不統一**: 現行系統預期為 `XXXXXXX_XX_XX` 格式，但這些檔案中的 `lot no` 包含非結構化文字 (例如: `32-H5 UT-1 2507173 02 17`)。

## 3. 與 P3_0902_P24 相關的資料 (Lot: 2507173)
以下檔案包含與 `P3_0902_P24.csv` 相同批號 (`2507173`) 的資料，這些資料目前無法直接匯入系統：

| 檔案名稱 | 範例 Lot No 內容 |
|:--- |:--- |
| `P3_0901_P21.csv` | `32-H5 UT-2 2507173 02 04` |
| `P3_0901_P23.csv` | `UT-2 2507173 02 07` |
| `P3_0902_P24.csv` | `32-H5 UT-1 2507173 02 17` |
| `P3_0903_P21.csv` | `2507173 02 02` |
| `P3_0903_P23.csv` | `32-H5 UT-3 2507173 02 06` |
| `P3_0909_P23.csv` | `32-H5 UT-2 2507173 02 01` |

## 4. 格式差異分析
現行系統與 `P3_check_09` 資料夾的格式差異對照：

| 項目 | 現行標準格式 (P3) | P3_check_09 格式 | 影響 |
|:--- |:--- |:--- |:--- |
| **識別欄位** | `P3_No.` (必要) | 無 | 無法建立 Product ID |
| **批號欄位** | 從 `P3_No.` 前9碼擷取 | `lot no` 欄位 | 需修改解析邏輯 |
| **批號格式** | `YYYYMMDD_Machine_Mold_Lot` | 混合文字 (e.g. `32-H5...`) | 需使用正規表示式提取 |
| **卷收機編號** | `P3_No.` 最後2碼 | `lot no` 最後2碼 (需解析) | 需修改解析邏輯 |

## 5. 建議處理方式
若需支援此類資料匯入，建議採取以下措施：
1. **修改上傳邏輯**: 允許缺少 `P3_No.` 的檔案上傳。
2. **新增解析規則**: 針對 `lot no` 欄位增加正規表示式提取規則，從 `32-H5 UT-1 2507173 02 17` 中提取出 `2507173_02` 與 `17`。
3. **自動生成 ID**: 若無 `P3_No.`，需由系統根據日期、機台、批號自動生成唯一 ID。
