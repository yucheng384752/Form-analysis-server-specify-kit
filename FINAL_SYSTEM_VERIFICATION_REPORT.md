# 系統全流程功能驗證報告

## 1. 測試環境與目標
- **環境**: Docker Container (Frontend, Backend, Database)
- **目標**: 驗證系統在容器化環境下的完整功能，包括檔案上傳、資料匯入、日期提取邏輯及高級搜尋功能。
- **測試時間**: 2025-12-16

## 2. 測試項目與結果摘要

| 測試項目 | 測試內容 | 結果 | 備註 |
|:---:|:---|:---:|:---|
| **前端連線** | 容器啟動與 HTTP 存取 | ✅ 通過 | 修復 HMR 配置後，回應 200 OK |
| **後端 API** | API 存活檢查 | ✅ 通過 | 回應 200 OK |
| **檔案上傳** | P1/P2/P3 格式上傳 | ✅ 通過 | 均成功取得 process_id |
| **資料匯入** | 將上傳檔案寫入資料庫 | ✅ 通過 | 均成功匯入，無錯誤 |
| **日期提取** | P1 (西元年) | ✅ 通過 | 正確提取 `2023-10-10` |
| **日期提取** | P2 (民國年 `112/10/10`) | ✅ 通過 | 正確轉換為 `2023-10-10` |
| **日期提取** | P3 (中文民國年 `112年10月10日`) | ✅ 通過 | 正確轉換為 `2023-10-10` |
| **高級搜尋** | 日期範圍篩選 | ✅ 通過 | 準確篩選出指定範圍內的記錄 |
| **高級搜尋** | 關鍵字模糊搜尋 | ✅ 通過 | 準確匹配批號部分字串 |

## 3. 詳細測試過程

### 3.1 P2/P3 日期提取驗證
針對 P2 與 P3 特殊的日期格式（民國年與中文日期），建立了專用測試檔案進行驗證。

- **P2 測試**:
  - 檔案: `P2_2503033_97.csv`
  - 輸入: `分條時間: 112/10/10`
  - 結果: 資料庫儲存為 `2023-10-10`
  - 驗證指令:
    ```powershell
    Invoke-RestMethod .../api/query/records/advanced?lot_no=2503033_97
    ```

- **P3 測試**:
  - 檔案: `P3_2503033_96.csv`
  - 輸入: `year-month-day: 112年10月10日`
  - 結果: 資料庫儲存為 `2023-10-10`
  - 驗證指令:
    ```powershell
    Invoke-RestMethod .../api/query/records/advanced?lot_no=2503033_96
    ```

### 3.2 高級搜尋功能驗證
驗證 API `/api/query/records/advanced` 的篩選能力。

- **日期範圍測試**:
  - 條件: `production_date_from=2023-10-01`, `production_date_to=2023-10-31`
  - 結果: 成功回傳上述 P1/P2/P3 三筆 `2023-10-10` 的記錄，排除其他日期的記錄。

- **關鍵字測試**:
  - 條件: `lot_no=2503033_9`
  - 結果: 成功回傳批號包含 `2503033_9` 的所有記錄 (96, 97, 98, 99)。

## 4. 結論與建議
系統核心功能在 Docker 環境下運作正常。
1. **前端**: 已解決 404 問題，可正常存取。
2. **後端**: 已修復 P1 匯入時的日期提取 Bug。
3. **資料處理**: P1/P2/P3 的多種日期格式均能正確解析與標準化。
4. **查詢**: 高級搜尋功能運作符合預期。

**建議**:
- 開發團隊可基於此版本進行後續 UI 優化。
- 建議定期備份資料庫，以防測試資料累積過多。
